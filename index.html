<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Guess Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: #121213;
            color: #ffffff;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .header {
            text-align: center;
            padding: 20px;
            border-bottom: 1px solid #3a3a3c;
            width: 100%;
            max-width: 500px;
        }

        h1 {
            font-size: 32px;
            font-weight: bold;
            letter-spacing: 2px;
        }

        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex-grow: 1;
            max-width: 500px;
            width: 100%;
        }

        .board {
            display: grid;
            grid-template-rows: repeat(6, 1fr);
            gap: 5px;
            padding: 20px 0;
            margin: 20px 0;
        }

        .row {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 5px;
        }

        .tile {
            width: 62px;
            height: 62px;
            border: 2px solid #3a3a3c;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: bold;
            text-transform: uppercase;
            transition: all 0.2s ease;
        }

        .tile.filled {
            border-color: #565758;
            animation: pop 0.1s ease;
        }

        .tile.correct {
            background-color: #538d4e;
            border-color: #538d4e;
            animation: flip 0.5s ease;
        }

        .tile.present {
            background-color: #b59f3b;
            border-color: #b59f3b;
            animation: flip 0.5s ease;
        }

        .tile.absent {
            background-color: #3a3a3c;
            border-color: #3a3a3c;
            animation: flip 0.5s ease;
        }

        @keyframes pop {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }

            100% {
                transform: scale(1);
            }
        }

        @keyframes flip {
            0% {
                transform: rotateX(0);
            }

            50% {
                transform: rotateX(90deg);
            }

            100% {
                transform: rotateX(0);
            }
        }

        .keyboard {
            width: 100%;
            max-width: 500px;
            padding: 10px;
        }

        .keyboard-row {
            display: flex;
            justify-content: center;
            gap: 6px;
            margin-bottom: 8px;
        }

        .key {
            min-width: 43px;
            height: 58px;
            border-radius: 4px;
            background-color: #818384;
            color: #ffffff;
            font-weight: bold;
            border: none;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s ease;
        }

        .key:hover {
            background-color: #9a9a9a;
        }

        .key.wide {
            min-width: 65px;
        }

        .key.correct {
            background-color: #538d4e;
        }

        .key.present {
            background-color: #b59f3b;
        }

        .key.absent {
            background-color: #3a3a3c;
        }

        .message {
            position: fixed;
            top: 100px;
            background-color: #ffffff;
            color: #000000;
            padding: 16px;
            border-radius: 4px;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
        }

        .message.show {
            opacity: 1;
        }

        .stats {
            margin-top: 20px;
            text-align: center;
        }

        .stats button {
            margin-top: 10px;
            padding: 12px 24px;
            background-color: #538d4e;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
        }

        .stats button:hover {
            background-color: #6aaa64;
        }

        /* Prevent zoom on double-tap for touch devices */
        * {
            touch-action: manipulation;
        }

        /* Medium screens (tablets, large phones) */
        @media (max-width: 600px) {
            body {
                padding: 10px;
            }

            .header {
                padding: 10px;
            }

            h1 {
                font-size: 24px;
            }

            .board {
                padding: 10px 0;
                margin: 10px 0;
            }

            .tile {
                width: 52px;
                height: 52px;
                font-size: 28px;
            }

            .key {
                min-width: 32px;
                height: 50px;
                font-size: 13px;
            }

            .key.wide {
                min-width: 52px;
            }

            .keyboard-row {
                gap: 4px;
            }
        }

        /* Small screens (most phones) */
        @media (max-width: 400px) {
            body {
                padding: 5px;
            }

            .header {
                padding: 8px;
            }

            h1 {
                font-size: 20px;
                letter-spacing: 1px;
            }

            .board {
                gap: 4px;
                padding: 5px 0;
                margin: 5px 0;
            }

            .row {
                gap: 4px;
            }

            .tile {
                width: 48px;
                height: 48px;
                font-size: 24px;
                border-width: 1.5px;
            }

            .keyboard {
                padding: 5px;
            }

            .keyboard-row {
                gap: 3px;
                margin-bottom: 5px;
            }

            .key {
                min-width: 28px;
                height: 45px;
                font-size: 11px;
                border-radius: 3px;
            }

            .key.wide {
                min-width: 45px;
                font-size: 10px;
            }

            .message {
                top: 60px;
                padding: 12px;
                font-size: 14px;
            }
        }

        /* Extra small screens (very small phones) */
        @media (max-width: 350px) {
            h1 {
                font-size: 18px;
            }

            .tile {
                width: 42px;
                height: 42px;
                font-size: 20px;
            }

            .row {
                gap: 3px;
            }

            .key {
                min-width: 24px;
                height: 40px;
                font-size: 10px;
            }

            .key.wide {
                min-width: 40px;
                font-size: 9px;
            }
        }

        /* Landscape mode on mobile - reduce vertical space */
        @media (max-height: 500px) and (orientation: landscape) {
            .header {
                padding: 5px;
            }

            h1 {
                font-size: 18px;
            }

            .board {
                margin: 5px 0;
                padding: 5px 0;
            }

            .tile {
                width: 40px;
                height: 40px;
                font-size: 20px;
            }

            .key {
                height: 38px;
            }
        }

        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }

        /* Help icon and modal styles */
        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .help-icon {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background-color: #3a3a3c;
            border: 2px solid #565758;
            color: #ffffff;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .help-icon:hover {
            background-color: #565758;
            border-color: #818384;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1001;
            padding: 20px;
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal {
            background-color: #1a1a1b;
            border-radius: 8px;
            max-width: 400px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            border-bottom: 1px solid #3a3a3c;
        }

        .modal-header h2 {
            font-size: 18px;
            margin: 0;
        }

        .modal-close {
            background: none;
            border: none;
            color: #818384;
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            line-height: 1;
        }

        .modal-close:hover {
            color: #ffffff;
        }

        .modal-body {
            padding: 20px;
        }

        .modal-body p {
            margin-bottom: 16px;
            line-height: 1.5;
            color: #d7dadc;
        }

        .modal-body h3 {
            font-size: 14px;
            margin-bottom: 12px;
            color: #ffffff;
        }

        .example-row {
            display: flex;
            gap: 4px;
            margin-bottom: 8px;
        }

        .example-tile {
            width: 36px;
            height: 36px;
            border: 2px solid #3a3a3c;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: bold;
        }

        .example-tile.correct {
            background-color: #538d4e;
            border-color: #538d4e;
        }

        .example-tile.present {
            background-color: #b59f3b;
            border-color: #b59f3b;
        }

        .example-tile.absent {
            background-color: #3a3a3c;
            border-color: #3a3a3c;
        }

        .example-desc {
            font-size: 13px;
            color: #818384;
            margin-bottom: 16px;
        }
    </style>
</head>

<body>
    <div class="header">
        <div class="header-content">
            <h1>WORD GUESS</h1>
            <button class="help-icon" id="help-btn" aria-label="How to play">?</button>
        </div>
    </div>

    <!-- Help Modal -->
    <div class="modal-overlay" id="help-modal">
        <div class="modal">
            <div class="modal-header">
                <h2>How To Play</h2>
                <button class="modal-close" id="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p>Guess the word in 6 tries. Each guess must be a valid 5-letter word.</p>
                <p>After each guess, the color of the tiles will change to show how close your guess was.</p>

                <h3>Examples</h3>

                <div class="example-row">
                    <div class="example-tile correct">W</div>
                    <div class="example-tile">E</div>
                    <div class="example-tile">A</div>
                    <div class="example-tile">R</div>
                    <div class="example-tile">Y</div>
                </div>
                <p class="example-desc"><strong>W</strong> is in the word and in the correct spot.</p>

                <div class="example-row">
                    <div class="example-tile">P</div>
                    <div class="example-tile present">I</div>
                    <div class="example-tile">L</div>
                    <div class="example-tile">L</div>
                    <div class="example-tile">S</div>
                </div>
                <p class="example-desc"><strong>I</strong> is in the word but in the wrong spot.</p>

                <div class="example-row">
                    <div class="example-tile">V</div>
                    <div class="example-tile">A</div>
                    <div class="example-tile">G</div>
                    <div class="example-tile absent">U</div>
                    <div class="example-tile">E</div>
                </div>
                <p class="example-desc"><strong>U</strong> is not in the word in any spot.</p>

                <p>A new word is available each day!</p>
            </div>
        </div>
    </div>

    <div class="game-container">
        <div class="board" id="board"></div>

        <div class="keyboard">
            <div class="keyboard-row">
                <button class="key" data-key="Q">Q</button>
                <button class="key" data-key="W">W</button>
                <button class="key" data-key="E">E</button>
                <button class="key" data-key="R">R</button>
                <button class="key" data-key="T">T</button>
                <button class="key" data-key="Y">Y</button>
                <button class="key" data-key="U">U</button>
                <button class="key" data-key="I">I</button>
                <button class="key" data-key="O">O</button>
                <button class="key" data-key="P">P</button>
            </div>
            <div class="keyboard-row">
                <button class="key" data-key="A">A</button>
                <button class="key" data-key="S">S</button>
                <button class="key" data-key="D">D</button>
                <button class="key" data-key="F">F</button>
                <button class="key" data-key="G">G</button>
                <button class="key" data-key="H">H</button>
                <button class="key" data-key="J">J</button>
                <button class="key" data-key="K">K</button>
                <button class="key" data-key="L">L</button>
            </div>
            <div class="keyboard-row">
                <button class="key wide" data-key="ENTER">ENTER</button>
                <button class="key" data-key="Z">Z</button>
                <button class="key" data-key="X">X</button>
                <button class="key" data-key="C">C</button>
                <button class="key" data-key="V">V</button>
                <button class="key" data-key="B">B</button>
                <button class="key" data-key="N">N</button>
                <button class="key" data-key="M">M</button>
                <button class="key wide" data-key="BACKSPACE">âŒ«</button>
            </div>
        </div>
    </div>

    <div class="message" id="message"></div>
    <canvas id="confetti-canvas"></canvas>

    <script src="words.js"></script>
    <script>
        // WORDS and VALID_WORDS are loaded from words.js

        let targetWord = "";
        let currentRow = 0;
        let currentTile = 0;
        let gameOver = false;
        const guessedWords = [];
        const keyboardState = {};

        // Initialize game
        function init() {
            const epoch = new Date(2025, 0, 1);
            const today = new Date();
            const dayIndex = Math.floor((today - epoch) / (1000 * 60 * 60 * 24));

            // Use a seeded random number generator to pick a word
            // This ensures the word is the same for everyone on a given day
            // but the sequence of words appears random
            const randomValue = seededRandom(dayIndex);
            const wordIndex = Math.floor(randomValue * WORDS.length);

            targetWord = WORDS[wordIndex];
            console.log("Target word:", targetWord); // For testing - remove in production
            createBoard();
            addEventListeners();
            setupHelpModal();
        }

        // Simple seeded random number generator (Mulberry32)
        function seededRandom(a) {
            let t = a += 0x6D2B79F5;
            t = Math.imul(t ^ t >>> 15, t | 1);
            t ^= t + Math.imul(t ^ t >>> 7, t | 61);
            return ((t ^ t >>> 14) >>> 0) / 4294967296;
        }

        // Create game board
        function createBoard() {
            const board = document.getElementById("board");
            for (let i = 0; i < 6; i++) {
                const row = document.createElement("div");
                row.className = "row";
                for (let j = 0; j < 5; j++) {
                    const tile = document.createElement("div");
                    tile.className = "tile";
                    tile.id = `tile-${i}-${j}`;
                    row.appendChild(tile);
                }
                board.appendChild(row);
            }
        }

        // Add event listeners
        function addEventListeners() {
            document.addEventListener("keydown", handleKeyPress);
            document.querySelectorAll(".key").forEach(key => {
                key.addEventListener("click", () => {
                    handleKeyPress({ key: key.getAttribute("data-key") });
                });
            });
        }

        // Handle key press
        function handleKeyPress(e) {
            if (gameOver) return;

            const key = e.key ? e.key.toUpperCase() : e.key;

            if (key === "BACKSPACE") {
                deleteLetter();
            } else if (key === "ENTER") {
                checkWord();
            } else if (key.length === 1 && key.match(/[A-Z]/)) {
                addLetter(key);
            }
        }

        // Add letter to current tile
        function addLetter(letter) {
            if (currentTile < 5) {
                const tile = document.getElementById(`tile-${currentRow}-${currentTile}`);
                tile.textContent = letter;
                tile.classList.add("filled");
                currentTile++;
            }
        }

        // Delete last letter
        function deleteLetter() {
            if (currentTile > 0) {
                currentTile--;
                const tile = document.getElementById(`tile-${currentRow}-${currentTile}`);
                tile.textContent = "";
                tile.classList.remove("filled");
            }
        }

        // Check if word is valid and update board
        function checkWord() {
            if (currentTile < 5) {
                showMessage("Not enough letters");
                return;
            }

            const guess = getCurrentWord();

            if (guessedWords.includes(guess)) {
                showMessage("Word already guessed");
                shakeRow();
                return;
            }

            if (!VALID_WORDS.includes(guess)) {
                showMessage("Not in word list");
                shakeRow();
                return;
            }

            guessedWords.push(guess);
            flipTiles(guess);

            if (guess === targetWord) {
                gameOver = true;
                setTimeout(() => {
                    showMessage("Excellent! ðŸŽ‰");
                    celebrateWin();
                }, 1500);
            } else if (currentRow === 5) {
                gameOver = true;
                setTimeout(() => {
                    showMessage(`The word was ${targetWord}`);
                }, 1500);
            } else {
                currentRow++;
                currentTile = 0;
            }
        }

        // Get current word from tiles
        function getCurrentWord() {
            let word = "";
            for (let i = 0; i < 5; i++) {
                const tile = document.getElementById(`tile-${currentRow}-${i}`);
                word += tile.textContent;
            }
            return word;
        }

        // Flip tiles with animation
        function flipTiles(guess) {
            const letterCount = {};
            for (let char of targetWord) {
                letterCount[char] = (letterCount[char] || 0) + 1;
            }

            const status = Array(5).fill("absent");

            // First pass: mark correct positions
            for (let i = 0; i < 5; i++) {
                if (guess[i] === targetWord[i]) {
                    status[i] = "correct";
                    letterCount[guess[i]]--;
                }
            }

            // Second pass: mark present letters
            for (let i = 0; i < 5; i++) {
                if (status[i] !== "correct" && targetWord.includes(guess[i]) && letterCount[guess[i]] > 0) {
                    status[i] = "present";
                    letterCount[guess[i]]--;
                }
            }

            // Apply colors with delay
            for (let i = 0; i < 5; i++) {
                const tile = document.getElementById(`tile-${currentRow}-${i}`);
                setTimeout(() => {
                    tile.classList.add(status[i]);
                    updateKeyboard(guess[i], status[i]);
                }, i * 300);
            }
        }

        // Update keyboard colors
        function updateKeyboard(letter, status) {
            const priority = { correct: 3, present: 2, absent: 1 };
            const currentStatus = keyboardState[letter];

            if (!currentStatus || priority[status] > priority[currentStatus]) {
                keyboardState[letter] = status;
                const key = document.querySelector(`[data-key="${letter}"]`);
                if (key) {
                    key.classList.remove("correct", "present", "absent");
                    key.classList.add(status);
                }
            }
        }

        // Show message
        function showMessage(text) {
            const message = document.getElementById("message");
            message.textContent = text;
            message.classList.add("show");
            setTimeout(() => {
                message.classList.remove("show");
            }, 2000);
        }

        // Shake row animation
        function shakeRow() {
            const row = document.querySelectorAll(`#tile-${currentRow}-0`)[0].parentElement;
            row.style.animation = "shake 0.5s";
            setTimeout(() => {
                row.style.animation = "";
            }, 500);
        }

        // Celebrate win
        function celebrateWin() {
            const tiles = document.querySelectorAll(`[id^="tile-${currentRow}"]`);
            tiles.forEach((tile, index) => {
                setTimeout(() => {
                    tile.style.animation = "bounce 0.5s";
                }, index * 100);
            });
            startConfetti();
        }

        // Confetti Animation
        function startConfetti() {
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            const particles = [];
            const colors = ['#f44336', '#e91e63', '#9c27b0', '#673ab7', '#3f51b5', '#2196f3', '#03a9f4', '#00bcd4', '#009688', '#4caf50', '#8bc34a', '#cddc39', '#ffeb3b', '#ffc107', '#ff9800', '#ff5722'];

            function createParticle() {
                const x = Math.random() * canvas.width;
                const y = -10;
                const size = Math.random() * 10 + 5;
                const color = colors[Math.floor(Math.random() * colors.length)];
                const speedY = Math.random() * 3 + 2;
                const speedX = Math.random() * 2 - 1;
                const rotation = Math.random() * 360;
                const rotationSpeed = Math.random() * 10 - 5;

                particles.push({ x, y, size, color, speedY, speedX, rotation, rotationSpeed });
            }

            function updateParticles() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                if (particles.length < 200) {
                    createParticle();
                }

                for (let i = 0; i < particles.length; i++) {
                    const p = particles[i];
                    p.y += p.speedY;
                    p.x += p.speedX;
                    p.rotation += p.rotationSpeed;

                    ctx.save();
                    ctx.translate(p.x, p.y);
                    ctx.rotate(p.rotation * Math.PI / 180);
                    ctx.fillStyle = p.color;
                    ctx.fillRect(-p.size / 2, -p.size / 2, p.size, p.size);
                    ctx.restore();

                    if (p.y > canvas.height) {
                        particles.splice(i, 1);
                        i--;
                    }
                }

                if (!gameOver) return; // Stop if game resets (though currently no reset implemented)
                requestAnimationFrame(updateParticles);
            }

            // Run for 5 seconds
            const animationId = requestAnimationFrame(updateParticles);
            setTimeout(() => {
                cancelAnimationFrame(animationId);
                ctx.clearRect(0, 0, canvas.width, canvas.height);
            }, 5000);
        }

        // Add shake animation
        const style = document.createElement("style");
        style.textContent = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
                20%, 40%, 60%, 80% { transform: translateX(5px); }
            }
            @keyframes bounce {
                0%, 100% { transform: translateY(0); }
                50% { transform: translateY(-20px); }
            }
        `;
        document.head.appendChild(style);

        // Start game
        // Setup help modal event listeners
        function setupHelpModal() {
            const helpBtn = document.getElementById('help-btn');
            const modal = document.getElementById('help-modal');
            const closeBtn = document.getElementById('modal-close');

            helpBtn.addEventListener('click', () => {
                modal.classList.add('show');
            });

            closeBtn.addEventListener('click', () => {
                modal.classList.remove('show');
            });

            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.classList.remove('show');
                }
            });
        }

        init();
    </script>
</body>

</html>